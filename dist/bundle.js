(()=>{"use strict";var e={203:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Field=void 0,t.Field=class{constructor(e,t){this.squares=[],e?this.setSquares(e):t?this.createSquares(!0):this.createSquares()}getSquares(){return this.squares.map((e=>e.slice()))}setSquares(e){this.squares=e}createSquares(e){for(let t=0;t<5;t++){this.squares[t]=new Array;for(let s=0;s<5;s++)if(e){let e="",i=Math.random();e=i<.25?"000000":i<.5?"444444":i<.75?"aaaaaa":"ffffff",this.squares[t][s]=e}else{let e=Math.floor(16777215*Math.random()).toString(16);this.squares[t][s]=e}}return console.log(this.squares),this.squares}swapSquares(e,t){const s=this.squares.map((e=>e.slice()));return this.squares[e.x][e.y]=this.squares[t.x][t.y].slice(),this.squares[t.x][t.y]=s[e.x][e.y].slice(),this.squares}}},243:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Fitness=void 0,t.Fitness=class{calcFitness(e){let t=0,s=e.getSquares();for(let e=0;e<s.length;e++)for(let i=0;i<s[e].length-1;i++)t+=this.averageColorDistance(s,e,i);return document.getElementById("fitness").innerHTML="Fitness: "+t.toFixed(4),t}hexToRGB(e){let t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]}calcColorDistance(e,t){const s=e[0]-t[0],i=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(s*s+i*i+a*a)}averageColorDistance(e,t,s){const i=[[0,1],[1,0],[0,-1],[-1,0],[-1,-1],[-1,1],[1,-1],[1,1]];let a=this.hexToRGB(e[t][s]),n=0,r=0;for(let[l,o]of i){let i=t+l,u=s+o;if(i>=0&&i<e.length&&u>=0&&u<e[0].length){let t=this.hexToRGB(e[i][u]);n+=this.calcColorDistance(a,t),r++}}return 0===r?0:n/r}}},432:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(a,n){function r(e){try{o(i.next(e))}catch(e){n(e)}}function l(e){try{o(i.throw(e))}catch(e){n(e)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,l)}o((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.HillClimber=void 0;const a=s(203),n=s(243),r=s(803);t.HillClimber=class{constructor(){this.curPopulations=[],this.fitness=new n.Fitness,this.delay=e=>new Promise((t=>setTimeout(t,e)))}hillclimber(e,t,s){return i(this,void 0,void 0,(function*(){let i=0,a=this.createInitialPopulation(s).map((e=>({value:this.fitness.calcFitness(e),item:e})));a.sort(((e,t)=>e.value-t.value));let n=a.slice(0,1).map((e=>e.item));for(console.log("Start: "+this.fitness.calcFitness(n[0]));i<e;){i++;let s=[];for(let a=0;a<Math.floor(t);a++){let t=this.mutateCandidate(n[0],i,e),a={value:this.fitness.calcFitness(t),item:t};s.push(a)}s.sort(((e,t)=>e.value-t.value));let a=s.slice(0,1).map((e=>e.item));this.fitness.calcFitness(a[0])<this.fitness.calcFitness(n[0])&&(n=a),r.Visual.getInstance().update(n[0]),r.Visual.getInstance().updateCurGeneration(i),yield this.delay(1)}}))}getPopulation(){return this.curPopulations}createCandidate(e){let t=[];for(let s=0;s<e;s++)t[s]=Math.round(Math.random());return t}createInitialPopulation(e){let t=new a.Field(void 0,e),s=[];for(let e=0;e<10;e++){let e=new a.Field(t.getSquares());for(let t=0;t<100;t++){let t=this.chooseRandomTile(),s=this.chooseRandomTile();e.swapSquares(t,s)}s.push(e)}return this.curPopulations=s,s}chooseRandomTile(){return{x:Math.floor(5*Math.random()),y:Math.floor(5*Math.random())}}rateCandidate(e){for(let t=0;t<e.length;t++)if(1==e[t])return t;return e.length}rateCandidateBalanced(e){let t=this.rateCandidate(e),s=0;for(let t=0;t<e.length;t++)1==e[t]&&s++;return Math.min(t,s)}mutateCandidate(e,t,s){let i=new a.Field(e.getSquares().map((e=>e.slice())));for(let e=0;e<20*Math.round(Math.random());e++){let e=this.chooseRandomTile(),t=this.chooseRandomTile();i.swapSquares(e,t)}return i}mutateCandidateProbability(e){let t=e.slice();for(let s=0;s<e.length;s++)Math.random()<1/e.length&&(t[s]=1-e[s]);return t}}},803:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Visual=void 0;const i=s(243);class a{constructor(){this.squaresDiv=this.getId("squares"),this.selectedTile={x:-1,y:-1},this.fitness=new i.Fitness,a.instance=this}static getInstance(){return a.instance}getId(e){return document.getElementById(e)}visualizeSquares(e){var t,s;let i=e.getSquares();this.squaresDiv.innerHTML="";const a=this;for(let n=0;n<i.length;n++){let r=document.createElement("div");null===(t=this.squaresDiv)||void 0===t||t.appendChild(r);for(let t=0;t<i[n].length;t++){let r=document.createElement("div");r.id=n+""+t,r.style.backgroundColor="#"+i[n][t],r.addEventListener("click",(function(){a.swapTiles(e,{x:Number(this.id.charAt(0)),y:Number(this.id.charAt(1))})})),null===(s=this.squaresDiv)||void 0===s||s.children[n].appendChild(r)}}}updateCurGeneration(e){this.getId("currentGeneration").innerHTML="Current Generation: "+e}swapTiles(e,t){if(-1==this.selectedTile.x&&-1==this.selectedTile.y)this.selectedTile=t,this.getId(this.selectedTile.x+""+this.selectedTile.y).className="selected";else{let s=t;this.getId(this.selectedTile.x+""+this.selectedTile.y).className="",this.getId(s.x+""+s.y).className="",e.swapSquares(this.selectedTile,s),this.selectedTile={x:-1,y:-1},this.update(e)}}update(e){this.visualizeSquares(e),this.fitness.calcFitness(e)}}t.Visual=a,a.instance=new a,t.default=a.getInstance()},927:(e,t,s)=>{t.ZZ=void 0;const i=s(203),a=s(803),n=s(432),r=f("resetBtn"),l=f("nextPopBtn"),o=f("populationSize"),u=f("maxGenerations"),c=f("bwCheckbox"),h=f("startAlgo");r.addEventListener("click",(function(){const e=localStorage.getItem("squares");e?t.ZZ.setSquares(JSON.parse(e).squares):t.ZZ.createSquares(),a.Visual.getInstance().updateCurGeneration(0),a.Visual.getInstance().update(t.ZZ)})),l.addEventListener("click",(function(){let e=d.getPopulation(),s=Number(l.getAttribute("num"));t.ZZ.setSquares(e[s].getSquares()),s==e.length-1?(s=0,l.setAttribute("num","0")):(s++,l.setAttribute("num",s.toString())),f("numberOfPopulation").innerHTML="Number of Population: "+s,a.Visual.getInstance().update(t.ZZ)})),h.addEventListener("click",(function(){d.hillclimber(Number(u.value),Number(o.value),c.checked)})),t.ZZ=new i.Field,localStorage.setItem("squares",JSON.stringify(t.ZZ));let d=new n.HillClimber;function f(e){return document.getElementById(e)}a.Visual.getInstance().update(t.ZZ)}},t={};!function s(i){var a=t[i];if(void 0!==a)return a.exports;var n=t[i]={exports:{}};return e[i].call(n.exports,n,n.exports,s),n.exports}(927)})();