(()=>{"use strict";var e={980:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Field=void 0,t.Field=class{constructor(e,t){this.squares=[],e?this.setSquares(e):t?this.createSquares(!0):this.createSquares()}getSquares(){return this.squares.map((e=>e.slice()))}setSquares(e){this.squares=e}createSquares(e){for(let t=0;t<10;t++){this.squares[t]=new Array;for(let s=0;s<10;s++)if(e){let e=Math.random()>.5?"000000":"ffffff";this.squares[t][s]=e}else{let e=Math.floor(16777215*Math.random()).toString(16);this.squares[t][s]=e}}return console.log(this.squares),this.squares}swapSquares(e,t){const s=this.squares.map((e=>e.slice()));return this.squares[e.x][e.y]=this.squares[t.x][t.y].slice(),this.squares[t.x][t.y]=s[e.x][e.y].slice(),this.squares}}},38:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Visual=void 0;const i=s(752);class n{constructor(){this.squaresDiv=this.getId("squares"),this.selectedTile={x:-1,y:-1},this.fitness=new i.Fitness,n.instance=this}static getInstance(){return n.instance}getId(e){return document.getElementById(e)}visualizeSquares(e){var t,s;let i=e.getSquares();this.squaresDiv.innerHTML="";const n=this;for(let a=0;a<i.length;a++){let r=document.createElement("div");null===(t=this.squaresDiv)||void 0===t||t.appendChild(r);for(let t=0;t<i[a].length;t++){let r=document.createElement("div");r.id=a+""+t,r.style.backgroundColor="#"+i[a][t],r.addEventListener("click",(function(){n.swapTiles(e,{x:Number(this.id.charAt(0)),y:Number(this.id.charAt(1))})})),null===(s=this.squaresDiv)||void 0===s||s.children[a].appendChild(r)}}}updateCurGeneration(e){this.getId("currentGeneration").innerHTML="Current Generation: "+e}swapTiles(e,t){if(-1==this.selectedTile.x&&-1==this.selectedTile.y)this.selectedTile=t,this.getId(this.selectedTile.x+""+this.selectedTile.y).className="selected";else{let s=t;this.getId(this.selectedTile.x+""+this.selectedTile.y).className="",this.getId(s.x+""+s.y).className="",e.swapSquares(this.selectedTile,s),this.selectedTile={x:-1,y:-1},this.update(e)}}update(e){this.visualizeSquares(e),this.fitness.calcFitness(e)}}t.Visual=n,n.instance=new n,t.default=n.getInstance()},752:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Fitness=void 0,t.Fitness=class{calcFitness(e){let t=0,s=e.getSquares();for(let e=0;e<s.length;e++)for(let i=0;i<s[e].length-1;i++)t+=this.averageColorDistance(s,e,i);return document.getElementById("fitness").innerHTML="Fitness: "+t.toFixed(4),t}hexToRGB(e){let t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]}calcColorDistance(e,t){const s=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(s*s+i*i+n*n)}averageColorDistance(e,t,s){const i=[[0,1],[1,0],[0,-1],[-1,0],[-1,-1],[-1,1],[1,-1],[1,1]];let n=this.hexToRGB(e[t][s]),a=0,r=0;for(let[l,o]of i){let i=t+l,u=s+o;if(i>=0&&i<e.length&&u>=0&&u<e[0].length){let t=this.hexToRGB(e[i][u]);a+=this.calcColorDistance(n,t),r++}}return 0===r?0:a/r}}},455:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function r(e){try{o(i.next(e))}catch(e){a(e)}}function l(e){try{o(i.throw(e))}catch(e){a(e)}}function o(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,l)}o((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.HillClimber=void 0;const n=s(980),a=s(752),r=s(38);t.HillClimber=class{constructor(){this.curPopulations=[],this.fitness=new a.Fitness,this.delay=e=>new Promise((t=>setTimeout(t,e)))}hillclimber2(e,t,s,i){let n=0,a=this.createCandidate(s),r=e(a);for(console.log(a.toString()+" - Gen: "+n+", Rating: "+e(a));r!=s&&n<i;){n++,r=e(a);let s=t(a);e(s)>r&&(a=s,console.log(a.toString()+" - Gen: "+n+", Rating: "+e(a)))}}hillclimber(e,t,s){return i(this,void 0,void 0,(function*(){let i=0,n=this.createInitialPopulation(s).map((e=>({value:this.fitness.calcFitness(e),item:e})));n.sort(((e,t)=>e.value-t.value));let a=n.slice(0,1).map((e=>e.item));for(console.log("Start: "+this.fitness.calcFitness(a[0]));i<e;){i++;let e=[];for(let s=0;s<Math.floor(t);s++){let t=this.mutateCandidate(a[0]),s={value:this.fitness.calcFitness(t),item:t};e.push(s)}e.sort(((e,t)=>e.value-t.value));let s=e.slice(0,1).map((e=>e.item));this.fitness.calcFitness(s[0])<this.fitness.calcFitness(a[0])&&(a=s),r.Visual.getInstance().update(a[0]),r.Visual.getInstance().updateCurGeneration(i),yield this.delay(1)}}))}getPopulation(){return this.curPopulations}createCandidate(e){let t=[];for(let s=0;s<e;s++)t[s]=Math.round(Math.random());return t}createInitialPopulation(e){let t=new n.Field(void 0,e),s=[];for(let e=0;e<10;e++){let e=new n.Field(t.getSquares());for(let t=0;t<100;t++){let t=this.chooseRandomTile(),s=this.chooseRandomTile();e.swapSquares(t,s)}s.push(e)}return this.curPopulations=s,s}chooseRandomTile(){return{x:Math.floor(10*Math.random()),y:Math.floor(10*Math.random())}}rateCandidate(e){for(let t=0;t<e.length;t++)if(1==e[t])return t;return e.length}rateCandidateBalanced(e){let t=this.rateCandidate(e),s=0;for(let t=0;t<e.length;t++)1==e[t]&&s++;return Math.min(t,s)}mutateCandidate(e){let t=new n.Field(e.getSquares().map((e=>e.slice())));for(let e=0;e<20*Math.round(Math.random());e++){let e=this.chooseRandomTile(),s=this.chooseRandomTile();t.swapSquares(e,s)}return t}mutateCandidateProbability(e){let t=e.slice();for(let s=0;s<e.length;s++)Math.random()<1/e.length&&(t[s]=1-e[s]);return t}}},550:(e,t,s)=>{t.ZZ=void 0;const i=s(980),n=s(38),a=s(455),r=f("resetBtn"),l=f("nextPopBtn"),o=f("populationSize"),u=f("maxGenerations"),c=f("bwCheckbox"),h=f("startAlgo");r.addEventListener("click",(function(){const e=localStorage.getItem("squares");e?t.ZZ.setSquares(JSON.parse(e).squares):t.ZZ.createSquares(),n.Visual.getInstance().updateCurGeneration(0),n.Visual.getInstance().update(t.ZZ)})),l.addEventListener("click",(function(){let e=d.getPopulation(),s=Number(l.getAttribute("num"));t.ZZ.setSquares(e[s].getSquares()),s==e.length-1?(s=0,l.setAttribute("num","0")):(s++,l.setAttribute("num",s.toString())),f("numberOfPopulation").innerHTML="Number of Population: "+s,n.Visual.getInstance().update(t.ZZ)})),h.addEventListener("click",(function(){d.hillclimber(Number(u.value),Number(o.value),c.checked)})),t.ZZ=new i.Field,localStorage.setItem("squares",JSON.stringify(t.ZZ));let d=new a.HillClimber;function f(e){return document.getElementById(e)}n.Visual.getInstance().update(t.ZZ)}},t={};!function s(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,s),a.exports}(550)})();